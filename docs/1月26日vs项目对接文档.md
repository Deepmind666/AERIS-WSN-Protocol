# AERIS-WSN-Protocol 项目对接文档

**日期**: 2026-01-26
**版本**: v2.0
**目标**: MDPI Sensors (Q2) 投稿

---

## 一、项目概述

### 1.1 项目名称
AERIS (Adaptive Environment-aware Routing with Intelligent Selection)
自适应环境感知智能选择路由协议

### 1.2 核心创新点
1. **模糊逻辑簇头选举** - 基于剩余能量、距离、链路质量的多因素决策
2. **LSTM链路质量预测** - 环境感知的链路可靠性预测
3. **上下文感知选择(CAS)** - 动态切换直连/链式/二跳模式
4. **骨干网络构建** - 智能网关选择和多跳路由
5. **多层可靠性机制** - Hop-ARQ、功率步进、邻居救援

### 1.3 当前状态
- **GPT评分**: 75/100
- **目标评分**: 85/100
- **主要问题**: 100% PDR可信度、LSTM贡献小、缺少现代基线

---

## 二、项目文件夹结构

```
AERIS-WSN-Protocol/
├── src/                    # 核心源代码
│   ├── aeris_protocol.py   # ⭐ 主协议实现 (102KB)
│   ├── cas_selector.py     # 上下文感知选择模块
│   ├── gateway_selector.py # 网关选择算法
│   ├── skeleton_selector.py# 骨干网络构建
│   ├── fuzzy_logic_system.py # 模糊逻辑系统
│   ├── lstm_prediction.py  # LSTM链路预测
│   ├── pytorch_lstm_env.py # PyTorch环境感知LSTM
│   ├── pytorch_tcn_env.py  # TCN时序预测
│   ├── realistic_channel_model.py # Log-Normal信道模型
│   ├── improved_energy_model.py   # CC2420能量模型
│   ├── baseline_protocols/ # 基线协议实现
│   │   ├── leach_protocol.py
│   │   ├── pegasis_protocol.py
│   │   └── heed_protocol.py
│   └── ...
│
├── scripts/                # 实验脚本
│   ├── run_sota_comparison.py    # SOTA对比实验
│   ├── run_scalability_experiment.py # 可扩展性实验
│   ├── generate_sota_figures.py  # 图表生成
│   ├── plot_paper_figures.py     # 论文图表
│   └── ...
│
├── docs/                   # 文档
│   ├── Paper_Draft_Section1_Introduction_REVISED.md
│   ├── Paper_Draft_Section2_Related_Work_COMPLETE.md
│   ├── Paper_Draft_Section3_System_Model_COMPLETE.md
│   ├── Paper_Draft_Section4_Algorithm_Design_REVISED.md
│   ├── Paper_Draft_Section5_Experimental_Setup_TRIMMED.md
│   ├── Paper_Draft_Section6_Results_REVISED.md
│   ├── Paper_Draft_Section7_Discussion_REVISED.md
│   ├── Paper_Draft_Section8_Conclusion_COMPLETE.md
│   ├── 2026-01-26_improvement_plan.md  # 改进计划
│   └── ...
│
├── results/                # 实验结果
│   ├── large_scale_scalability_verified.json  # ⭐ 验证数据
│   ├── mega_experiments/   # 大规模实验结果
│   ├── plots/              # 生成的图表
│   └── ...
│
├── for_submission/         # 投稿材料
│   ├── figures/            # 论文图表
│   ├── aeris_sensors_mdpi.tex  # LaTeX源文件
│   └── ...
│
├── data/                   # 数据集
│   ├── Intel_Lab_Data/     # Intel实验室数据
│   └── ...
│
├── tests/                  # 测试代码
├── configs/                # 配置文件
└── ns3_validation/         # NS-3验证代码
```

---

## 三、核心代码文件说明

### 3.1 主协议: aeris_protocol.py

**路径**: `src/aeris_protocol.py`
**大小**: 102KB, ~2800行
**重要性**: ⭐⭐⭐⭐⭐

**核心类和函数**:

| 行号 | 函数/类 | 功能 |
|------|---------|------|
| 1-100 | `AERISConfig` | 协议配置参数 |
| 100-300 | `AERISNode` | 节点类定义 |
| 300-500 | `AERISProtocol.__init__` | 协议初始化 |
| 500-700 | `run_round()` | 单轮仿真执行 |
| 700-812 | `cluster_formation()` | 簇形成算法 |
| **812-1000** | `transmit_to_bs()` | ⚠️ 可靠性传输 (需重构) |
| 1000-1200 | `select_cluster_heads()` | 簇头选举 |
| 1200-1400 | `build_routes()` | 路由构建 |

**关键问题**: `transmit_to_bs()` 函数200行，包含多层可靠性机制，是100% PDR的来源

### 3.2 上下文感知选择: cas_selector.py

**路径**: `src/cas_selector.py`
**功能**: 动态选择最优传输模式

```python
# 三种传输模式
MODE_DIRECT = 0   # 直连基站
MODE_CHAIN = 1    # 链式传输
MODE_TWO_HOP = 2  # 二跳中继
```

**核心逻辑**: 根据节点密度、链路质量、能量状态选择模式

### 3.3 网关选择: gateway_selector.py

**路径**: `src/gateway_selector.py`
**功能**: 选择最优网关节点构建骨干网络

### 3.4 模糊逻辑: fuzzy_logic_system.py

**路径**: `src/fuzzy_logic_system.py`
**功能**: 基于模糊推理的簇头评分

### 3.5 LSTM预测: lstm_prediction.py

**路径**: `src/lstm_prediction.py`
**功能**: 链路质量预测
**问题**: 消融实验显示仅贡献2-3% PDR提升

### 3.6 信道模型: realistic_channel_model.py

**路径**: `src/realistic_channel_model.py`
**模型**: Log-Normal Shadowing (σ=8dB)

### 3.7 能量模型: improved_energy_model.py

**路径**: `src/improved_energy_model.py`
**模型**: CC2420 TelosB能量模型

---

## 四、算法流程

### 4.1 AERIS主流程

```
┌─────────────────────────────────────────────────────────┐
│                    AERIS 协议流程                        │
├─────────────────────────────────────────────────────────┤
│  1. 初始化阶段                                           │
│     ├── 部署节点 (随机/网格)                             │
│     ├── 初始化能量 (0.5J/节点)                          │
│     └── 建立邻居表                                       │
├─────────────────────────────────────────────────────────┤
│  2. 簇形成阶段 (每轮)                                    │
│     ├── 模糊逻辑评分 → 选举簇头                          │
│     ├── CAS模式选择 → 直连/链式/二跳                     │
│     └── 网关选择 → 构建骨干网络                          │
├─────────────────────────────────────────────────────────┤
│  3. 数据传输阶段                                         │
│     ├── 节点→簇头 (簇内传输)                             │
│     ├── 簇头→网关 (骨干传输)                             │
│     └── 网关→基站 (上行传输)                             │
├─────────────────────────────────────────────────────────┤
│  4. 可靠性保障 (transmit_to_bs)                          │
│     ├── Hop-ARQ重传 (最多3次)                           │
│     ├── 功率步进 (逐级增加)                              │
│     ├── 备选父节点 (多路径)                              │
│     ├── 邻居救援 (广播请求)                              │
│     └── 最终回退 (直接广播)                              │
└─────────────────────────────────────────────────────────┘
```

### 4.2 模糊逻辑簇头选举

**输入变量**:
- 剩余能量比 (0-1)
- 到基站距离 (归一化)
- 邻居节点数

**输出**: 簇头适合度分数 (0-1)

---

## 五、实验数据

### 5.1 验证数据 (推荐使用)

**文件**: `results/large_scale_scalability_verified.json`

| 节点数 | AERIS | PEGASIS | LEACH | HEED |
|--------|-------|---------|-------|------|
| 100 | 99.9% | 87.6% | 65.2% | 66.9% |
| 200 | 90.8% | 75.3% | 52.0% | 50.7% |
| 300 | 85.0% | 64.3% | 45.9% | 44.0% |
| 500 | 78.9% | 56.0% | 38.1% | 34.2% |

**统计**: 30次重复, 200轮, p<0.001, Cohen's d>2.0

### 5.2 Mega实验结果

**目录**: `results/mega_experiments/`

| 实验 | 文件 | 状态 |
|------|------|------|
| 可扩展性 | exp1_scalability.json | ✅ |
| 长期运行 | exp2_longterm.json | ✅ |
| 多拓扑 | exp3_topology.json | ✅ |
| 消融 | exp4_ablation.json | ✅ |
| 敏感性 | exp5_sensitivity.json | ✅ |
| Bootstrap | exp6_bootstrap.json | ✅ |
| 压力测试 | exp7_stress.json | ✅ |
| Intel数据 | exp8_intel.json | ✅ |

---

## 六、已知问题与改进计划

### 6.1 GPT审查发现的问题

| 问题 | 严重性 | 状态 |
|------|--------|------|
| 100% PDR不可信 | 🔴 高 | 待修复 |
| LSTM贡献仅2-3% | 🔴 高 | 待讨论 |
| 缺少2023-2025文献 | 🔴 高 | 待添加 |
| 能量定位不准确 | 🟡 中 | 待调整 |
| transmit_to_bs过长 | 🟡 中 | 待重构 |

### 6.2 改进计划摘要

详见: `docs/2026-01-26_improvement_plan.md`

**时间表**: 2-3周完成所有P0/P1任务

---

## 七、运行指南

### 7.1 环境配置

```bash
# 创建虚拟环境
python -m venv .venv
.venv\Scripts\activate  # Windows

# 安装依赖
pip install -r requirements.txt
```

### 7.2 运行实验

```bash
# 运行SOTA对比实验
python scripts/run_sota_comparison.py

# 生成图表
python scripts/generate_sota_figures.py
```

---

## 八、关键文件快速索引

| 用途 | 文件路径 |
|------|----------|
| 主协议 | `src/aeris_protocol.py` |
| 验证数据 | `results/large_scale_scalability_verified.json` |
| 改进计划 | `docs/2026-01-26_improvement_plan.md` |
| 论文Section6 | `docs/Paper_Draft_Section6_Results_REVISED.md` |
| GPT审查意见 | `docs/2026年1月26日gpt审查意见.md` |

---

## 九、联系方式

**GitHub**: https://github.com/Deepmind666/AERIS-WSN-Protocol

---

**文档结束**

